# КурсНова: чат с куратором - Telegram бот

Этот бот предназначен для обработки запросов от учеников курса, их маршрутизации и организации взаимодействия с кураторами.

## Функциональность

- Регистрация запросов пользователей с возможностью категоризации
- Автоматические ответы на частые вопросы
- Перенаправление запросов кураторам с ID 2103397
- Автоматические уведомления, если ответ не предоставлен в течение заданного времени
- Возможность интеграции с внешними системами

## Установка и настройка

### Предварительные требования

- Node.js 16 или выше
- Telegram Bot Token (получите у [@BotFather](https://t.me/BotFather))
- Аккаунт на [Vercel](https://vercel.com/) (для деплоя)
- Git (для управления исходным кодом)

### Локальная настройка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/Ashzegna/knvbotcurator.git
cd knvbotcurator
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` на основе `.env.example` и заполните необходимые переменные:
```
BOT_TOKEN=your_bot_token_here
ADMIN_CHAT_ID=your_admin_chat_id_here
CURATOR_RESPONSE_TIMEOUT=15
```

4. Запустите бота в режиме разработки:
```bash
npm run dev
```

### Деплой на Vercel

1. Зарегистрируйтесь или войдите в [Vercel](https://vercel.com/)

2. Создайте новый проект и свяжите его с вашим GitHub-репозиторием

3. **ВАЖНО:** Настройте переменные окружения в панели управления Vercel:
   - Перейдите в раздел "Settings" -> "Environment Variables"
   - Добавьте следующие переменные:
     - `BOT_TOKEN` = Ваш токен бота
     - `ADMIN_CHAT_ID` = ID куратора (2103397)
     - `CURATOR_RESPONSE_TIMEOUT` = 15
     - `NODE_ENV` = production
   - Нажмите "Save" и перезапустите деплой

4. Настройте webhook для вашего бота:
   - Откройте в браузере следующий URL (замените YOUR_BOT_TOKEN на ваш токен):
   ```
   https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=https://ваш-проект.vercel.app/api/webhook
   ```

## Структура проекта

- `index.js` - Основной файл приложения
- `vercel.json` - Конфигурация для деплоя на Vercel
- `.env` - Файл с переменными окружения (не включен в репозиторий)
- `.env.example` - Пример конфигурации переменных окружения

## Работа с ботом

### Для учеников

1. Начните диалог с ботом, отправив команду `/start`
2. Выберите "Задать вопрос"
3. Выберите категорию вопроса
4. Напишите свой вопрос
5. Ожидайте ответа от куратора

### Для кураторов

1. При получении нового запроса вы получите уведомление в указанный чат
2. Нажмите на кнопку "Ответить на запрос"
3. Введите свой ответ
4. Ответ будет отправлен ученику

## Настройка категорий вопросов

Категории вопросов определены в файле `index.js` в константе `QUESTION_CATEGORIES`. Вы можете изменить их в соответствии с вашими потребностями.

## Настройка FAQ

Для изменения раздела часто задаваемых вопросов отредактируйте обработчик `bot.action(/faq_(.+)/` в файле `index.js`.
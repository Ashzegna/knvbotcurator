# КурсНова: чат с куратором - Telegram бот

Этот бот предназначен для обработки запросов от учеников курса, их маршрутизации и организации взаимодействия с кураторами.

## Функциональность

- Регистрация запросов пользователей с возможностью категоризации
- Автоматические ответы на частые вопросы
- Перенаправление запросов кураторам
- Автоматические уведомления, если ответ не предоставлен в течение заданного времени
- Возможность интеграции с внешними системами

## Установка и настройка

### Предварительные требования

- Node.js 16 или выше
- Telegram Bot Token (получите у [@BotFather](https://t.me/BotFather))
- Аккаунт на [Vercel](https://vercel.com/) (для деплоя)
- Git (для управления исходным кодом)

### Локальная настройка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/knvbot.git
cd knvbot
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` на основе `.env.example` и заполните необходимые переменные:
```
BOT_TOKEN=your_bot_token_here
ADMIN_CHAT_ID=your_admin_chat_id_here
CURATOR_RESPONSE_TIMEOUT=15
KITIK_API_URL=https://api.kitik.example.com
```

4. Запустите бота в режиме разработки:
```bash
npm run dev
```

### Деплой на Vercel

1. Зарегистрируйтесь или войдите в [Vercel](https://vercel.com/)

2. Установите Vercel CLI:
```bash
npm install -g vercel
```

3. Запустите деплой:
```bash
vercel
```

4. Следуйте инструкциям в командной строке, чтобы связать проект с вашим аккаунтом Vercel

5. Настройте переменные окружения в панели управления Vercel:
   - `BOT_TOKEN`
   - `ADMIN_CHAT_ID`
   - `CURATOR_RESPONSE_TIMEOUT`
   - `KITIK_API_URL`

6. Настройте webhook для вашего бота:
```
https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook?url=<YOUR_VERCEL_URL>
```

## Структура проекта

- `index.js` - Основной файл приложения
- `vercel.json` - Конфигурация для деплоя на Vercel
- `.env` - Файл с переменными окружения (не включен в репозиторий)
- `.env.example` - Пример конфигурации переменных окружения

## Работа с ботом

### Для учеников

1. Начните диалог с ботом, отправив команду `/start`
2. Выберите "Задать вопрос"
3. Выберите категорию вопроса
4. Напишите свой вопрос
5. Ожидайте ответа от куратора

### Для кураторов

1. При получении нового запроса вы получите уведомление в указанный чат
2. Нажмите на кнопку "Ответить на запрос"
3. Введите свой ответ
4. Ответ будет отправлен ученику

## Настройка категорий вопросов

Категории вопросов определены в файле `index.js` в константе `QUESTION_CATEGORIES`. Вы можете изменить их в соответствии с вашими потребностями.

## Настройка FAQ

Для изменения раздела часто задаваемых вопросов отредактируйте обработчик `bot.action(/faq_(.+)/` в файле `index.js`.